(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2951],{27600:(e,t,s)=>{"use strict";s.d(t,{A:()=>c,AuthProvider:()=>o});var a=s(95155),r=s(12115),l=s(93004),n=s(56104),i=s(68856);let d=r.createContext(void 0);function o(e){let{children:t}=e,[s,o]=r.useState(null),[c,u]=r.useState(!0);return(r.useEffect(()=>{let e=(0,l.hg)(n.j2,e=>{o(e),u(!1)},e=>{console.error("Auth state change error:",e),u(!1)});return()=>e()},[]),c)?(0,a.jsx)("div",{className:"flex h-screen w-screen items-center justify-center",children:(0,a.jsxs)("div",{className:"w-1/2 space-y-4",children:[(0,a.jsx)(i.E,{className:"h-12 w-full"}),(0,a.jsx)(i.E,{className:"h-32 w-full"}),(0,a.jsx)(i.E,{className:"h-32 w-full"})]})}):(0,a.jsx)(d.Provider,{value:{user:s,loading:c},children:t})}function c(){let e=r.useContext(d);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},30241:(e,t,s)=>{"use strict";s.d(t,{Ff:()=>m,he:()=>f,lV:()=>p});var a=s(80644),r=s(20908),l=s(53941),n=s(24386),i=s(70831),d=s(13774),o=s(63482),c=s(1407),u=s(76959);function m(e){let t=(0,a.o)(e),s=(0,r.C)(t),c=[...f(s),...f(s+1)].find(e=>(0,l.d)(e.payDate,t)||e.payDate.getTime()===t.getTime());if(c)return c;let u=new Date("2025-08-24T00:00:00"),m=Math.floor((0,n.c)(t,u)/14),p=(0,i.f)(u,14*m),h=(0,i.f)(p,13),x=(0,d.G)(h);return(0,o.Y)(x,t)&&(p=(0,i.f)(p,14),h=(0,i.f)(p,13),x=(0,d.G)(h)),{start:p,end:h,payDate:x}}function f(e){let t=new Date("2025-08-24T00:00:00"),s=[],a=(0,c.D)(new Date(e,0,1)),l=Math.floor((0,n.c)(a,t)/14),o=(0,i.f)(t,14*l);for(;(0,r.C)(o)<=e;){let t=(0,i.f)(o,13),a=(0,d.G)(t);(0,r.C)(o)===e&&s.push({start:o,end:t,payDate:a}),o=(0,i.f)(o,14)}return s}function p(e){let t=f((0,r.C)(e)).find(t=>(0,u.r)(t.start,e));return t?t.payDate:null}},30285:(e,t,s)=>{"use strict";s.d(t,{$:()=>o,r:()=>d});var a=s(95155),r=s(12115),l=s(99708),n=s(74466),i=s(59434);let d=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=r.forwardRef((e,t)=>{let{className:s,variant:r,size:n,asChild:o=!1,...c}=e,u=o?l.DX:"button";return(0,a.jsx)(u,{className:(0,i.cn)(d({variant:r,size:n,className:s})),ref:t,...c})});o.displayName="Button"},54165:(e,t,s)=>{"use strict";s.d(t,{Cf:()=>m,Es:()=>p,L3:()=>h,c7:()=>f,lG:()=>d,rr:()=>x,zM:()=>o});var a=s(95155),r=s(12115),l=s(15452),n=s(25318),i=s(59434);let d=l.bL,o=l.l9,c=l.ZL;l.bm;let u=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.hJ,{ref:t,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...r})});u.displayName=l.hJ.displayName;let m=r.forwardRef((e,t)=>{let{className:s,children:r,...d}=e;return(0,a.jsxs)(c,{children:[(0,a.jsx)(u,{}),(0,a.jsxs)(l.UC,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...d,children:[r,(0,a.jsxs)(l.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(n.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=l.UC.displayName;let f=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...s})};f.displayName="DialogHeader";let p=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s})};p.displayName="DialogFooter";let h=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.hE,{ref:t,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",s),...r})});h.displayName=l.hE.displayName;let x=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.VY,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",s),...r})});x.displayName=l.VY.displayName},55365:(e,t,s)=>{"use strict";s.d(t,{Fc:()=>d,TN:()=>c,XL:()=>o});var a=s(95155),r=s(12115),l=s(74466),n=s(59434);let i=(0,l.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),d=r.forwardRef((e,t)=>{let{className:s,variant:r,...l}=e;return(0,a.jsx)("div",{ref:t,role:"alert",className:(0,n.cn)(i({variant:r}),s),...l})});d.displayName="Alert";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("h5",{ref:t,className:(0,n.cn)("mb-1 font-medium leading-none tracking-tight",s),...r})});o.displayName="AlertTitle";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("text-sm [&_p]:leading-relaxed",s),...r})});c.displayName="AlertDescription"},56104:(e,t,s)=>{"use strict";let a,r,l;s.d(t,{db:()=>l,j2:()=>r});var n=s(23915),i=s(93004),d=s(35317);try{a=(0,n.Dk)().length?(0,n.Sx)():(0,n.Wp)({apiKey:"AIzaSyAkP18VtzDihlYGJYJoNsH48v83yHobkds",authDomain:"payroll-3582c.firebaseapp.com",projectId:"payroll-3582c",storageBucket:"payroll-3582c.firebasestorage.app",messagingSenderId:"595764753966",appId:"1:595764753966:web:33c2371bf504e8985e91bf",measurementId:"G-9TSQDML6N1"}),r=(0,i.xI)(a),l=(0,d.aU)(a)}catch(e){throw console.error("Firebase initialization error",e),Error("Failed to initialize Firebase. Please check your .env.local file and restart the server.")}},59409:(e,t,s)=>{"use strict";s.d(t,{bq:()=>m,eb:()=>x,gC:()=>h,l6:()=>c,yv:()=>u});var a=s(95155),r=s(12115),l=s(14582),n=s(79556),i=s(77381),d=s(10518),o=s(59434);let c=l.bL;l.YJ;let u=l.WT,m=r.forwardRef((e,t)=>{let{className:s,children:r,...i}=e;return(0,a.jsxs)(l.l9,{ref:t,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...i,children:[r,(0,a.jsx)(l.In,{asChild:!0,children:(0,a.jsx)(n.A,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=l.l9.displayName;let f=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.PP,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,a.jsx)(i.A,{className:"h-4 w-4"})})});f.displayName=l.PP.displayName;let p=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.wn,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,a.jsx)(n.A,{className:"h-4 w-4"})})});p.displayName=l.wn.displayName;let h=r.forwardRef((e,t)=>{let{className:s,children:r,position:n="popper",...i}=e;return(0,a.jsx)(l.ZL,{children:(0,a.jsxs)(l.UC,{ref:t,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:n,...i,children:[(0,a.jsx)(f,{}),(0,a.jsx)(l.LM,{className:(0,o.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,a.jsx)(p,{})]})})});h.displayName=l.UC.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.JU,{ref:t,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...r})}).displayName=l.JU.displayName;let x=r.forwardRef((e,t)=>{let{className:s,children:r,...n}=e;return(0,a.jsxs)(l.q7,{ref:t,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...n,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(l.VF,{children:(0,a.jsx)(d.A,{className:"h-4 w-4"})})}),(0,a.jsx)(l.p4,{children:r})]})});x.displayName=l.q7.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.wv,{ref:t,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",s),...r})}).displayName=l.wv.displayName},59434:(e,t,s)=>{"use strict";s.d(t,{cn:()=>l});var a=s(52596),r=s(39688);function l(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.QP)((0,a.$)(t))}},61976:()=>{},62523:(e,t,s)=>{"use strict";s.d(t,{p:()=>n});var a=s(95155),r=s(12115),l=s(59434);let n=r.forwardRef((e,t)=>{let{className:s,type:r,...n}=e;return(0,a.jsx)("input",{type:r,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","print:shadow-none print:border-gray-400 print:h-8",s),ref:t,...n})});n.displayName="Input"},66695:(e,t,s)=>{"use strict";s.d(t,{BT:()=>o,Wu:()=>c,ZB:()=>d,Zp:()=>n,aR:()=>i,wL:()=>u});var a=s(95155),r=s(12115),l=s(59434);let n=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...r})});n.displayName="Card";let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",s),...r})});i.displayName="CardHeader";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",s),...r})});d.displayName="CardTitle";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",s),...r})});o.displayName="CardDescription";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",s),...r})});c.displayName="CardContent";let u=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",s),...r})});u.displayName="CardFooter"},68856:(e,t,s)=>{"use strict";s.d(t,{E:()=>l});var a=s(95155),r=s(59434);function l(e){let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,r.cn)("animate-pulse rounded-md bg-muted",t),...s})}},71581:()=>{},73983:()=>{},79926:(e,t,s)=>{Promise.resolve().then(s.bind(s,86309))},84660:()=>{},85057:(e,t,s)=>{"use strict";s.d(t,{J:()=>o});var a=s(95155),r=s(12115),l=s(40968),n=s(74466),i=s(59434);let d=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.b,{ref:t,className:(0,i.cn)(d(),s),...r})});o.displayName=l.b.displayName},85127:(e,t,s)=>{"use strict";s.d(t,{A0:()=>i,BF:()=>d,Gg:()=>o,Hj:()=>c,XI:()=>n,nA:()=>m,nd:()=>u,r6:()=>f});var a=s(95155),r=s(12115),l=s(59434);let n=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:t,className:(0,l.cn)("w-full caption-bottom text-sm",s),...r})})});n.displayName="Table";let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("thead",{ref:t,className:(0,l.cn)("[&_tr]:border-b",s),...r})});i.displayName="TableHeader";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tbody",{ref:t,className:(0,l.cn)("[&_tr:last-child]:border-0",s),...r})});d.displayName="TableBody";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tfoot",{ref:t,className:(0,l.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...r})});o.displayName="TableFooter";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tr",{ref:t,className:(0,l.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...r})});c.displayName="TableRow";let u=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("th",{ref:t,className:(0,l.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...r})});u.displayName="TableHead";let m=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("td",{ref:t,className:(0,l.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...r})});m.displayName="TableCell";let f=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("caption",{ref:t,className:(0,l.cn)("mt-4 text-sm text-muted-foreground",s),...r})});f.displayName="TableCaption"},86309:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>q});var a=s(95155),r=s(12115),l=s(66695),n=s(30285),i=s(31949),d=s(50172),o=s(77223),c=s(50286),u=s(75943),m=s(12543),f=s(60679),p=s(389),h=s(41784),x=s(9208),y=s(20908),j=s(44861),g=s(80644),v=s(76959),N=s(7860),b=s(27600),w=s(35317),C=s(56104),M=s(87481),A=s(68856),S=s(6874),P=s.n(S),k=s(54165),I=s(62523),D=s(85057),E=s(55365),T=s(59409),O=s(55035),R=s(85127),G=s(30241);function _(e){let{open:t,onOpenChange:s,onPinVerified:l}=e,[o,c]=r.useState(""),[u,m]=r.useState(""),[f,p]=r.useState(!1),{user:h}=(0,b.A)(),x=async()=>{if(!h)return void m("You must be logged in.");p(!0),m("");try{let e=(0,w.H9)(C.db,"users",h.uid),t=await (0,w.x7)(e);t.exists()&&t.data().securityPin===o||t.exists()&&!t.data().securityPin?l():m("Invalid PIN. Please try again.")}catch(e){m("An error occurred while verifying the PIN.")}finally{p(!1),c("")}};return(0,a.jsx)(k.lG,{open:t,onOpenChange:s,children:(0,a.jsxs)(k.Cf,{className:"sm:max-w-md",children:[(0,a.jsxs)(k.c7,{children:[(0,a.jsx)(k.L3,{children:"Enter Security PIN"}),(0,a.jsx)(k.rr,{children:"Enter your 4-digit PIN to modify this time entry."})]}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[u&&(0,a.jsxs)(E.Fc,{variant:"destructive",children:[(0,a.jsx)(i.A,{className:"h-4 w-4"}),(0,a.jsx)(E.XL,{children:"Error"}),(0,a.jsx)(E.TN,{children:u})]}),(0,a.jsx)(I.p,{type:"password",maxLength:4,placeholder:"••••",value:o,onChange:e=>{c(e.target.value.replace(/\D/g,""))},className:"text-center text-2xl tracking-[1rem]"}),(0,a.jsx)(n.$,{onClick:x,className:"w-full",disabled:f||4!==o.length,children:f?(0,a.jsx)(d.A,{className:"mr-2 h-4 w-4 animate-spin"}):"Verify PIN"})]})]})})}let F=(e,t)=>{let s=e.target.value.replace(/[^0-9]/g,""),a=s;s.length>2&&(a="".concat(s.slice(0,2),":").concat(s.slice(2,4))),t(a)};function H(e){let{isOpen:t,onClose:s,employee:l,date:o,onSave:c}=e,{user:u}=(0,b.A)(),{toast:m}=(0,M.dj)(),[f,x]=r.useState(!1),[y,j]=r.useState(""),[g,v]=r.useState("09:00"),[N,A]=r.useState("AM"),[S,P]=r.useState("05:00"),[O,R]=r.useState("PM"),G=async()=>{if(!u||!l||!o)return;j("");let e=(0,p.qg)("".concat(g," ").concat(N),"hh:mm a",o),t=(0,p.qg)("".concat(S," ").concat(O),"hh:mm a",o);if(t<e)return void j("Clock-out time cannot be before clock-in time.");x(!0);try{let s=(0,w.rJ)(C.db,"users",u.uid,"employees",l.id,"timeEntries");await (0,w.gS)(s,{timeIn:w.Dc.fromDate(e),timeOut:w.Dc.fromDate(t),employeeId:l.id,employeeName:l.firstName}),m({title:"Success",description:"Time entry created successfully."}),c()}catch(e){console.error("Error creating time entry:",e),m({title:"Error",description:"Failed to create time entry.",variant:"destructive"})}finally{x(!1)}};return l&&o?(0,a.jsx)(k.lG,{open:t,onOpenChange:s,children:(0,a.jsxs)(k.Cf,{children:[(0,a.jsxs)(k.c7,{children:[(0,a.jsx)(k.L3,{children:"Add Time Entry"}),(0,a.jsxs)(k.rr,{children:["Create a new entry for ",l.firstName," on ",(0,h.GP)(o,"PPP"),"."]})]}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[y&&(0,a.jsxs)(E.Fc,{variant:"destructive",children:[(0,a.jsx)(i.A,{className:"h-4 w-4"}),(0,a.jsx)(E.XL,{children:y})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(D.J,{children:"Clock In"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(I.p,{value:g,onChange:e=>F(e,v),placeholder:"hh:mm"}),(0,a.jsxs)(T.l6,{value:N,onValueChange:e=>A(e),children:[(0,a.jsx)(T.bq,{children:(0,a.jsx)(T.yv,{})}),(0,a.jsxs)(T.gC,{children:[(0,a.jsx)(T.eb,{value:"AM",children:"AM"}),(0,a.jsx)(T.eb,{value:"PM",children:"PM"})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(D.J,{children:"Clock Out"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(I.p,{value:S,onChange:e=>F(e,P),placeholder:"hh:mm"}),(0,a.jsxs)(T.l6,{value:O,onValueChange:e=>R(e),children:[(0,a.jsx)(T.bq,{children:(0,a.jsx)(T.yv,{})}),(0,a.jsxs)(T.gC,{children:[(0,a.jsx)(T.eb,{value:"AM",children:"AM"}),(0,a.jsx)(T.eb,{value:"PM",children:"PM"})]})]})]})]})]})]}),(0,a.jsxs)(k.Es,{children:[(0,a.jsx)(n.$,{variant:"outline",onClick:s,children:"Cancel"}),(0,a.jsxs)(n.$,{onClick:G,disabled:f,children:[f&&(0,a.jsx)(d.A,{className:"mr-2 h-4 w-4 animate-spin"})," Save Entry"]})]})]})}):null}function z(e){let{isOpen:t,onClose:s,entry:l,date:c,onSave:u,onDeleteRequest:m}=e,{user:f}=(0,b.A)(),{toast:x}=(0,M.dj)(),[y,j]=r.useState(!1),[g,v]=r.useState(""),[N,A]=r.useState("09:00"),[S,P]=r.useState("AM"),[O,R]=r.useState("05:00"),[G,_]=r.useState("PM"),[H,z]=r.useState(!0);r.useEffect(()=>{if(l){let e=l.timeIn.toDate();if(A((0,h.GP)(e,"hh:mm")),P((0,h.GP)(e,"a")),l.timeOut){let e=l.timeOut.toDate();R((0,h.GP)(e,"hh:mm")),_((0,h.GP)(e,"a")),z(!0)}else z(!1),R("05:00"),_("PM")}},[l]);let L=async()=>{if(!f||!l||!c)return;v("");let e=(0,p.qg)("".concat(N," ").concat(S),"hh:mm a",c),t=null;if(H&&(t=(0,p.qg)("".concat(O," ").concat(G),"hh:mm a",c)),t&&t<e)return void v("Clock-out time cannot be before clock-in time.");j(!0);try{let s=(0,w.H9)(C.db,"users",f.uid,"employees",l.employeeId,"timeEntries",l.id);await (0,w.mZ)(s,{timeIn:w.Dc.fromDate(e),timeOut:t?w.Dc.fromDate(t):null}),x({title:"Success",description:"Time entry updated successfully."}),u()}catch(e){console.error("Error updating time entry:",e),x({title:"Error",description:"Failed to update time entry.",variant:"destructive"})}finally{j(!1)}};return l&&c?(0,a.jsx)(k.lG,{open:t,onOpenChange:s,children:(0,a.jsxs)(k.Cf,{children:[(0,a.jsxs)(k.c7,{children:[(0,a.jsx)(k.L3,{children:"Edit Time Entry"}),(0,a.jsxs)(k.rr,{children:["Adjust the clock-in/out times for ",(0,h.GP)(c,"PPP"),"."]})]}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[g&&(0,a.jsxs)(E.Fc,{variant:"destructive",children:[(0,a.jsx)(i.A,{className:"h-4 w-4"}),(0,a.jsx)(E.XL,{children:g})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(D.J,{children:"Clock In"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(I.p,{value:N,onChange:e=>F(e,A),placeholder:"hh:mm"}),(0,a.jsxs)(T.l6,{value:S,onValueChange:e=>P(e),children:[(0,a.jsx)(T.bq,{children:(0,a.jsx)(T.yv,{})}),(0,a.jsxs)(T.gC,{children:[(0,a.jsx)(T.eb,{value:"AM",children:"AM"}),(0,a.jsx)(T.eb,{value:"PM",children:"PM"})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(D.J,{children:"Clock Out"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(I.p,{value:O,onChange:e=>F(e,R),placeholder:"hh:mm",disabled:!H}),(0,a.jsxs)(T.l6,{value:G,onValueChange:e=>_(e),disabled:!H,children:[(0,a.jsx)(T.bq,{children:(0,a.jsx)(T.yv,{})}),(0,a.jsxs)(T.gC,{children:[(0,a.jsx)(T.eb,{value:"AM",children:"AM"}),(0,a.jsx)(T.eb,{value:"PM",children:"PM"})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 mt-2",children:[(0,a.jsx)("input",{type:"checkbox",id:"isClockedOut",checked:!H,onChange:e=>z(!e.target.checked)}),(0,a.jsx)("label",{htmlFor:"isClockedOut",className:"text-xs font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Still clocked in?"})]})]})]})]}),(0,a.jsxs)(k.Es,{className:"justify-between",children:[(0,a.jsxs)(n.$,{variant:"destructive",onClick:()=>m(l),children:[(0,a.jsx)(o.A,{className:"mr-2 h-4 w-4"})," Delete Entry"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(n.$,{variant:"outline",onClick:s,children:"Cancel"}),(0,a.jsxs)(n.$,{onClick:L,disabled:y,children:[y&&(0,a.jsx)(d.A,{className:"mr-2 h-4 w-4 animate-spin"})," Save"]})]})]})]})}):null}function L(e){let{isOpen:t,onClose:s,date:r,summary:l,onEditRequest:i}=e;return r&&l?(0,a.jsx)(k.lG,{open:t,onOpenChange:s,children:(0,a.jsxs)(k.Cf,{className:"sm:max-w-lg",children:[(0,a.jsxs)(k.c7,{children:[(0,a.jsxs)(k.L3,{className:"flex items-center",children:[(0,a.jsx)(c.A,{className:"mr-2 h-5 w-5"})," Daily Activity Summary"]}),(0,a.jsxs)(k.rr,{children:[l.employeeName," on ",(0,h.GP)(r,"PPP"),"."]})]}),(0,a.jsx)("div",{className:"max-h-[60vh] overflow-y-auto",children:l.entries.length>0?(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("h4",{className:"font-semibold",children:["Total Hours: ",(0,a.jsx)("span",{className:"font-bold text-primary",children:l.totalHours.toFixed(2)})]}),(0,a.jsx)("ul",{className:"space-y-2 pl-4",children:l.entries.map(e=>{var t,s;return(0,a.jsxs)("li",{className:"text-sm list-disc list-inside flex items-center justify-between p-2 border rounded-md",children:[(0,a.jsxs)("span",{children:[(0,h.GP)(e.timeIn.toDate(),"p")," - ",e.timeOut?(0,h.GP)(e.timeOut.toDate(),"p"):"...",(0,a.jsxs)("span",{className:"ml-2 text-muted-foreground",children:["(",V(e.timeIn.toDate(),null!=(s=null==(t=e.timeOut)?void 0:t.toDate())?s:null),")"]})]}),(0,a.jsx)(n.$,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>i(e),children:(0,a.jsx)(u.A,{className:"h-3 w-3"})})]},e.id)})})]}):(0,a.jsx)("p",{className:"text-center text-muted-foreground py-10",children:"No activity was recorded for this day."})})]})}):null}let V=(e,t)=>{if(!t)return"Active";let s=(0,x.o)(t,e);if(s<0)return"0h 0m";let a=Math.floor(s/60);return"".concat(a,"h ").concat(s%60,"m")};function q(){var e,t,s,i;let{user:d}=(0,b.A)(),{toast:o}=(0,M.dj)(),[c,u]=r.useState([]),[S,k]=r.useState([]),[I,D]=r.useState(!0),[E,F]=r.useState(),[V,q]=r.useState([]),[J,$]=r.useState(""),B=r.useRef(null),U=r.useRef(null);r.useEffect(()=>{let e=new Date,t=(0,y.C)(e);q((0,G.he)(t));let s=(0,G.Ff)(e);$("".concat((0,h.GP)(s.start,"yyyy-MM-dd"),"_").concat((0,h.GP)(s.end,"yyyy-MM-dd"))),F({from:s.start,to:s.end})},[]);let[X,Y]=r.useState(!1),[Z,W]=r.useState({date:null,summary:null}),[Q,K]=r.useState(!1),[ee,et]=r.useState(!1),[es,ea]=r.useState(null),[er,el]=r.useState(!1),[en,ei]=r.useState(null),[ed,eo]=r.useState(null),ec=r.useCallback(async()=>{if(!d||!(null==E?void 0:E.from)||!(null==E?void 0:E.to)){k([]),D(!1);return}D(!0);try{let e=(0,w.rJ)(C.db,"users",d.uid,"employees"),t=(0,w.P)(e,(0,w.My)("firstName","asc")),s=(await (0,w.GG)(t)).docs.map(e=>({id:e.id,...e.data()}));u(s);let a=[],r=new Date(E.to);for(let e of(r.setHours(23,59,59,999),s)){let t=(0,w.rJ)(C.db,"users",d.uid,"employees",e.id,"timeEntries"),s=(0,w.P)(t,(0,w._M)("timeIn",">=",E.from),(0,w._M)("timeIn","<=",r),(0,w.My)("timeIn","desc")),l=(await (0,w.GG)(s)).docs.map(t=>({id:t.id,...t.data(),employeeId:e.id,employeeName:e.firstName})),n=new Map;l.forEach(e=>{let t=(0,h.GP)((0,g.o)(e.timeIn.toDate()),"yyyy-MM-dd"),s=n.get(t)||{totalMinutes:0,entries:[]};if(e.timeOut){let t=(0,x.o)(e.timeOut.toDate(),e.timeIn.toDate());s.totalMinutes+=t>0?t:0}s.entries.push(e),n.set(t,s)}),n.forEach((t,s)=>{a.push({employeeId:e.id,employeeName:e.firstName,date:(0,p.qg)(s,"yyyy-MM-dd",new Date),totalHours:t.totalMinutes/60,entries:t.entries.sort((e,t)=>e.timeIn.toDate().getTime()-t.timeIn.toDate().getTime())})})}k(a)}catch(e){console.error("Error fetching timesheets:",e),o({title:"Error",description:"Could not fetch timesheet data.",variant:"destructive"})}finally{D(!1)}},[d,E,o]);r.useEffect(()=>{ec()},[ec]);let eu=(e,t)=>{let s=S.find(s=>s.employeeId===e.id&&(0,v.r)(s.date,t));s?(W({date:s.date,summary:s}),Y(!0)):(eo("add"),ei({employee:e,date:t}),K(!0))},em=async()=>{if(d&&es)try{let{entry:e}=es,t=(0,w.H9)(C.db,"users",d.uid,"employees",e.employeeId,"timeEntries",e.id);await (0,w.kd)(t),o({title:"Success",description:"Time entry deleted."}),ef()}catch(e){console.error("Error deleting entry:",e),o({title:"Error",description:"Failed to delete time entry.",variant:"destructive"})}},ef=()=>{et(!1),ea(null),eo(null),ec()},ep=E&&E.from&&E.to?(0,N.k)({start:E.from,end:E.to}):[],eh=r.useMemo(()=>{let e=new Map;return c.forEach(t=>e.set(t.id,0)),S.forEach(t=>{let s=e.get(t.employeeId)||0;e.set(t.employeeId,s+t.totalHours)}),e},[c,S]);return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(n.$,{variant:"outline",asChild:!0,className:"w-fit",children:(0,a.jsxs)(P(),{href:"/dashboard",children:[(0,a.jsx)(m.A,{className:"mr-2 h-4 w-4"})," Back to Dashboard"]})}),(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Consolidated Timesheet"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Review total logged hours for all employees. Click on a cell to view or edit detailed punch entries."}),(0,a.jsxs)(l.Zp,{children:[(0,a.jsx)(l.aR,{children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)(l.ZB,{children:"Time Log Summary"}),(0,a.jsx)(l.BT,{children:"Select a pay period to view time entries."})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 w-full sm:w-auto items-center",children:[(0,a.jsxs)(T.l6,{value:J,onValueChange:e=>{$(e);let[t,s]=e.split("_"),a=(0,p.qg)(t,"yyyy-MM-dd",new Date),r=(0,p.qg)(s,"yyyy-MM-dd",new Date);(0,j.f)(a)&&(0,j.f)(r)&&F({from:a,to:r})},children:[(0,a.jsx)(T.bq,{className:"w-full sm:w-[380px]",children:(0,a.jsx)(T.yv,{placeholder:"Select a pay period..."})}),(0,a.jsx)(T.gC,{children:V.map((e,t)=>{let s="".concat((0,h.GP)(e.start,"yyyy-MM-dd"),"_").concat((0,h.GP)(e.end,"yyyy-MM-dd"));return(0,a.jsxs)(T.eb,{value:s,children:[(0,h.GP)(e.start,"MM/dd/yy")," - ",(0,h.GP)(e.end,"MM/dd/yy")," (Pay Date: ",(0,h.GP)(e.payDate,"MM/dd/yy"),")"]},t)})})]}),(0,a.jsxs)(n.$,{variant:"outline",onClick:()=>{if(!c.length||!ep.length||!(null==E?void 0:E.from)||!E.to)return void o({title:"No Data",description:"There is no data to export.",variant:"destructive"});let e=O.utils.book_new(),t=[],s=[],a=0,r=["Date","Metric",...c.map(e=>"".concat(e.firstName))];t.push(r),a++,ep.forEach(e=>{let r=S.filter(t=>(0,v.r)(t.date,e)),l=[(0,h.GP)(e,"eee, MMM dd"),"In:"];c.forEach(e=>{var t;let s=r.find(t=>t.employeeId===e.id),a=s?s.entries.length>1?"Multiple":(null==(t=s.entries[0])?void 0:t.timeIn)?(0,h.GP)(s.entries[0].timeIn.toDate(),"p"):"-":"-";l.push(a)}),t.push(l);let n=["","Out:"];c.forEach(e=>{var t,s;let a=r.find(t=>t.employeeId===e.id),l=a?a.entries.length>1?"Multiple":(null==(t=a.entries[0])?void 0:t.timeOut)?(0,h.GP)(a.entries[0].timeOut.toDate(),"p"):(null==(s=a.entries[0])?void 0:s.timeIn)?"ACTIVE":"-":"-";n.push(l)}),t.push(n);let i=["","Total:"];c.forEach(e=>{let t=r.find(t=>t.employeeId===e.id),s=t&&t.totalHours>0?"".concat(t.totalHours.toFixed(2)):"-";i.push(s)}),t.push(i),a>0&&s.push({s:{r:a,c:0},e:{r:a+2,c:0}}),a+=3});let l=["Total Hours","",...c.map(e=>(eh.get(e.id)||0).toFixed(2))];t.push(l);let n=O.utils.aoa_to_sheet(t);n["!merges"]=s;let i=[{wch:15},{wch:8},...c.map(()=>({wch:20}))];n["!cols"]=i,O.utils.book_append_sheet(e,n,"Timesheet");let d="timesheet (".concat((0,h.GP)(E.from,"yyyy-MM-dd")," to ").concat((0,h.GP)(E.to,"yyyy-MM-dd"),").xlsx");O.writeFile(e,d)},children:[(0,a.jsx)(f.A,{className:"mr-2 h-4 w-4"}),"Export"]})]})]})}),(0,a.jsx)(l.Wu,{children:I?(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(A.E,{className:"h-12 w-full"}),(0,a.jsx)(A.E,{className:"h-12 w-full"}),(0,a.jsx)(A.E,{className:"h-12 w-full"})]}):c.length>0?(0,a.jsxs)("div",{className:"border rounded-lg",children:[(0,a.jsx)("div",{className:"relative overflow-hidden",ref:B,children:(0,a.jsx)(R.XI,{children:(0,a.jsx)(R.A0,{children:(0,a.jsxs)(R.Hj,{children:[(0,a.jsx)(R.nd,{className:"w-[120px] sticky left-0 bg-card z-20",children:"Date"}),(0,a.jsx)(R.nd,{className:"w-[80px] sticky left-[120px] bg-card z-20",children:"Metric"}),c.map(e=>(0,a.jsx)(R.nd,{className:"min-w-[150px] text-center",children:e.firstName},e.id))]})})})}),(0,a.jsx)("div",{className:"max-h-[60vh] overflow-auto",ref:U,onScroll:()=>{B.current&&U.current&&(B.current.scrollLeft=U.current.scrollLeft)},children:(0,a.jsx)(R.XI,{children:(0,a.jsxs)(R.BF,{children:[ep.map(e=>{let t=S.filter(t=>(0,v.r)(t.date,e));return(0,a.jsxs)(r.Fragment,{children:[(0,a.jsxs)(R.Hj,{children:[(0,a.jsx)(R.nA,{rowSpan:3,className:"font-medium align-top pt-3 border-b sticky left-0 bg-card z-10 w-[120px]",children:(0,h.GP)(e,"eee, MMM dd")}),(0,a.jsx)(R.nA,{className:"font-semibold text-muted-foreground p-2 sticky left-[120px] bg-card z-10 w-[80px]",children:"In:"}),c.map(s=>{var r;let l=t.find(e=>e.employeeId===s.id);return(0,a.jsx)(R.nA,{className:"text-center tabular-nums cursor-pointer p-2 min-w-[150px]",onClick:()=>eu(s,e),children:l?l.entries.length>1?"Multiple":(null==(r=l.entries[0])?void 0:r.timeIn)?(0,h.GP)(l.entries[0].timeIn.toDate(),"p"):"-":"-"},"".concat(s.id,"-in"))})]}),(0,a.jsxs)(R.Hj,{children:[(0,a.jsx)(R.nA,{className:"font-semibold text-muted-foreground p-2 sticky left-[120px] bg-card z-10 w-[80px]",children:"Out:"}),c.map(s=>{var r,l;let n=t.find(e=>e.employeeId===s.id);return(0,a.jsx)(R.nA,{className:"text-center tabular-nums cursor-pointer p-2 min-w-[150px]",onClick:()=>eu(s,e),children:n?n.entries.length>1?"Multiple":(null==(r=n.entries[0])?void 0:r.timeOut)?(0,h.GP)(n.entries[0].timeOut.toDate(),"p"):(null==(l=n.entries[0])?void 0:l.timeIn)?(0,a.jsx)("span",{className:"text-accent font-semibold",children:"ACTIVE"}):"-":"-"},"".concat(s.id,"-out"))})]}),(0,a.jsxs)(R.Hj,{children:[(0,a.jsx)(R.nA,{className:"font-bold p-2 sticky left-[120px] bg-card z-10 w-[80px]",children:"Total:"}),c.map(s=>{let r=t.find(e=>e.employeeId===s.id);return(0,a.jsx)(R.nA,{className:"text-center font-bold tabular-nums cursor-pointer p-2 min-w-[150px]",onClick:()=>eu(s,e),children:r&&r.totalHours>0?"".concat(r.totalHours.toFixed(2)):"-"},"".concat(s.id,"-total"))})]})]},e.toISOString())}),(0,a.jsxs)(R.Hj,{children:[(0,a.jsx)(R.nA,{colSpan:2,className:"sticky left-0 bg-card z-10 font-bold p-2 text-right w-[200px]",children:"Total Hours"}),c.map(e=>(0,a.jsx)(R.nA,{className:"font-bold text-primary tabular-nums p-2 text-center min-w-[150px]",children:(eh.get(e.id)||0).toFixed(2)},e.id))]})]})})})]}):(0,a.jsx)("div",{className:"text-center py-10 text-muted-foreground",children:"No employees found. Add an employee to get started."})})]}),(0,a.jsx)(L,{isOpen:X,onClose:()=>Y(!1),date:Z.date,summary:Z.summary,onEditRequest:e=>{Z.date&&(eo("edit"),ea({entry:e,date:Z.date}),K(!0))}}),(0,a.jsx)(_,{open:Q,onOpenChange:K,onPinVerified:()=>{K(!1),"edit"===ed&&es?(Y(!1),et(!0)):"add"===ed&&en?el(!0):"delete"===ed&&es&&em()}}),(0,a.jsx)(z,{isOpen:ee,onClose:()=>et(!1),entry:null!=(e=null==es?void 0:es.entry)?e:null,date:null!=(t=null==es?void 0:es.date)?t:null,onSave:ef,onDeleteRequest:e=>{eo("delete"),ea({entry:e,date:new Date}),K(!0)}}),(0,a.jsx)(H,{isOpen:er,onClose:()=>el(!1),employee:null!=(s=null==en?void 0:en.employee)?s:null,date:null!=(i=null==en?void 0:en.date)?i:null,onSave:()=>{el(!1),ei(null),eo(null),ec()}})]})}},87481:(e,t,s)=>{"use strict";s.d(t,{dj:()=>m});var a=s(12115);let r=0,l=new Map,n=e=>{if(l.has(e))return;let t=setTimeout(()=>{l.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);l.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?n(s):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},d=[],o={toasts:[]};function c(e){o=i(o,e),d.forEach(e=>{e(o)})}function u(e){let{...t}=e,s=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>c({type:"DISMISS_TOAST",toastId:s});return c({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||a()}}}),{id:s,dismiss:a,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function m(){let[e,t]=a.useState(o);return a.useEffect(()=>(d.push(t),()=>{let e=d.indexOf(t);e>-1&&d.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}}},e=>{var t=t=>e(e.s=t);e.O(0,[2992,7416,2394,8693,3796,3873,1784,5740,1345,5411,5886,5452,4480,6568,8441,1684,7358],()=>t(79926)),_N_E=e.O()}]);