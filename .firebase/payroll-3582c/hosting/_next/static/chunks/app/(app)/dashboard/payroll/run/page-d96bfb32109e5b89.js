(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[56],{55669:(e,t,s)=>{Promise.resolve().then(s.bind(s,64066))},63482:(e,t,s)=>{"use strict";s.d(t,{Y:()=>r});var a=s(35476);function r(e,t){return+(0,a.a)(e)<+(0,a.a)(t)}},64066:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>b});var a=s(95155),r=s(12115),l=s(35695),i=s(70831),n=s(41784),d=s(44829),c=s(30285),o=s(66695),u=s(3638),m=s(50172),x=s(51920),h=s(23422),f=s(14636),p=s(85511),j=s(59434),y=s(85057),N=s(35317),g=s(56104),w=s(27600);function P(){let{user:e}=(0,w.A)(),t=(0,l.useSearchParams)().get("id"),[s,P]=r.useState(),[b,v]=r.useState(),[D,L]=r.useState(null),[E,S]=r.useState(!0),[G,A]=r.useState(!0),[k,C]=r.useState([]),[M,B]=r.useState(null),F=!!t;r.useEffect(()=>{if(!F){let e=localStorage.getItem("lastPayrollEndDate");if(e){let t=new Date(e),s=(0,i.f)(t,1),a=(0,i.f)(s,13);P(s),v(a)}}},[F]),r.useEffect(()=>{if(!e)return void A(!1);(async()=>{A(!0);try{let t=(0,N.rJ)(g.db,"users",e.uid,"payrolls"),s=(0,N.P)(t,(0,N.My)("toDate","desc")),a=await (0,N.GG)(s),r=a.docs.map(e=>{let t=e.data(),[s,a,r]=t.fromDate.split("-").map(Number),[l,i,n]=t.toDate.split("-").map(Number);return{from:new Date(s,a-1,r),to:new Date(l,i-1,n)}});if(C(r),!a.empty){let e=a.docs[0].data(),[t,s,r]=e.fromDate.split("-").map(Number),[l,i,d]=e.toDate.split("-").map(Number),c=new Date(t,s-1,r),o=new Date(l,i-1,d);B("".concat((0,n.GP)(c,"LLL dd, y")," - ").concat((0,n.GP)(o,"LLL dd, y")))}}catch(e){console.error("Error fetching payroll data:",e)}finally{A(!1)}})()},[e]),r.useEffect(()=>{if(t&&e){S(!0);let s=(0,N.H9)(g.db,"users",e.uid,"payrolls",t);(0,N.x7)(s).then(e=>{if(e.exists()){let t={id:e.id,...e.data()};L(t);let[s,a,r]=t.fromDate.split("-").map(Number),[l,i,n]=t.toDate.split("-").map(Number);P(new Date(s,a-1,r)),v(new Date(l,i-1,n))}else console.error("No such payroll document!")}).catch(e=>{console.error("Error fetching payroll:",e)}).finally(()=>{S(!1)})}else S(!1)},[t,e]);let Z=e=>{if(F)return!1;for(let t of k)if(e>=t.from&&e<=t.to)return!0;return!1};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:F?"Edit Payroll":"Run New Payroll"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:F?"Editing payroll for period: ".concat(D&&s&&b?(0,n.GP)(s,"LLL dd, y")+" - "+(0,n.GP)(b,"LLL dd, y"):"..."):"Calculate employee payroll for a specific period."})]}),!F&&M&&(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"text-sm font-medium flex items-center text-muted-foreground",children:[(0,a.jsx)(u.A,{className:"mr-2 h-4 w-4"})," Last Payroll Run"]}),(0,a.jsx)("p",{className:"text-sm font-semibold",children:M})]})]}),E||G?(0,a.jsxs)(o.Zp,{children:[(0,a.jsx)(o.aR,{children:(0,a.jsx)(o.ZB,{children:"Loading Payroll Data..."})}),(0,a.jsx)(o.Wu,{children:(0,a.jsx)("div",{className:"flex items-center justify-center py-10",children:(0,a.jsx)(m.A,{className:"h-8 w-8 animate-spin text-muted-foreground"})})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(o.Zp,{children:[(0,a.jsxs)(o.aR,{children:[(0,a.jsx)(o.ZB,{children:"1. Pay Period"}),(0,a.jsx)(o.BT,{children:F?"The pay period for this run is locked.":"Choose the date range for this payroll run. Previously used dates are disabled."})]}),(0,a.jsx)(o.Wu,{children:(0,a.jsxs)("div",{className:"flex flex-wrap items-end gap-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(y.J,{htmlFor:"from-date",children:"From"}),(0,a.jsxs)(f.AM,{children:[(0,a.jsx)(f.Wv,{asChild:!0,children:(0,a.jsxs)(c.$,{id:"from-date",variant:"outline",className:(0,j.cn)("w-[240px] justify-start text-left font-normal",!s&&"text-muted-foreground"),disabled:F,children:[(0,a.jsx)(x.A,{className:"mr-2 h-4 w-4"}),s?(0,n.GP)(s,"LLL dd, y"):(0,a.jsx)("span",{children:"Pick a start date"})]})}),(0,a.jsx)(f.hl,{className:"w-auto p-0",align:"start",children:(0,a.jsx)(p.V,{mode:"single",selected:s,onSelect:P,disabled:e=>b&&e>b||e>new Date||F||Z(e),initialFocus:!0})})]})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(y.J,{htmlFor:"to-date",children:"To"}),(0,a.jsxs)(f.AM,{children:[(0,a.jsx)(f.Wv,{asChild:!0,children:(0,a.jsxs)(c.$,{id:"to-date",variant:"outline",className:(0,j.cn)("w-[240px] justify-start text-left font-normal",!b&&"text-muted-foreground"),disabled:F,children:[(0,a.jsx)(x.A,{className:"mr-2 h-4 w-4"}),b?(0,n.GP)(b,"LLL dd, y"):(0,a.jsx)("span",{children:"Pick an end date"})]})}),(0,a.jsx)(f.hl,{className:"w-auto p-0",align:"start",children:(0,a.jsx)(p.V,{mode:"single",selected:b,onSelect:v,disabled:e=>!s||e<s||e>new Date||F||Z(e),initialFocus:!0})})]})]})]})})]}),s&&b?(0,a.jsx)(d.B,{from:s,to:b,payrollId:t,initialPayrollData:D},t||"".concat((0,n.GP)(s,"yyyy-MM-dd"),"-").concat((0,n.GP)(b,"yyyy-MM-dd"))):(0,a.jsxs)(o.Zp,{children:[(0,a.jsxs)(o.aR,{children:[(0,a.jsxs)(o.ZB,{className:"flex items-center",children:[(0,a.jsx)(h.A,{className:"mr-2 h-5 w-5 text-muted-foreground"})," 2. Calculate Payroll"]}),(0,a.jsx)(o.BT,{children:"Enter hours for each employee for the selected pay period."})]}),(0,a.jsx)(o.Wu,{children:(0,a.jsx)("p",{className:"text-center text-muted-foreground py-10",children:"Please select a pay period above to begin."})})]})]})]})}function b(){return(0,a.jsx)(r.Suspense,{fallback:(0,a.jsx)("div",{className:"flex h-screen items-center justify-center",children:(0,a.jsx)(m.A,{className:"h-8 w-8 animate-spin"})}),children:(0,a.jsx)(P,{})})}},70831:(e,t,s)=>{"use strict";s.d(t,{f:()=>l});var a=s(35476),r=s(92084);function l(e,t){let s=(0,a.a)(e);return isNaN(t)?(0,r.w)(e,NaN):(t&&s.setDate(s.getDate()+t),s)}},79233:(e,t,s)=>{"use strict";s.d(t,{P:()=>r});var a=s(35476);function r(e){return(0,a.a)(e).getDay()}}},e=>{var t=t=>e(e.s=t);e.O(0,[2992,7416,3796,3873,1784,5740,1345,5521,9155,1207,394,9699,8441,1684,7358],()=>t(55669)),_N_E=e.O()}]);